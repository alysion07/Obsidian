## Basic 

#CORS 는 일종의 방어막. 
이 곳 저 곳에서 가져오는 리소스가 안전하다는 최소한의 보장

*'교차 출처 리소스 공유'* 로 해석되지만, **'교차 출처'** 보다는 **'다른 출처'** 라는 의미로 해석하는 것이 이해하기 쉽다.

### Origin이란 무엇?

서버의 위치를 의미하는 https://google.com 과 같은 URL들은 마치 하나의 문자열 같이 보여도, 사실은 여러개의 구성 요소로 이루어져 있다.

![[Pasted image 20240924085729.png]]

출처는 `protocol`, `host` 위 이미지엔 나와있지 않지만 `:80`, `:443`과 같은 포트 번호 까지 모두 합친 것을 의미한다.  


### SOP(Same-Origin Policy)
 
#SOP

**동일한 출처에서만 리소를 공유할 수 있다.** 는 법률을 의미한다.
즉, 동일출처(Same-Origin) 서버에 있는 리소스는 자유로이 가져올 수 있지만, 다른 출처(Cross-Origin)서버에 있는 이미지나 유튜브 영상 같은 리소스는 상호작용이 불가능 하다는 의미.

![[Pasted image 20241126100551.jpg|CORS 발생 상황|500]]

---

### SOP가 필요한 이유

출처가 다른 두 어플리케이션이 자유로이 소통할 수 있는 환경은 꽤 위험한 환경임.
제약이 없다면 CSRF(Cross-Site Request Fogery)나 XSS(Cross-Site Scripting) 등의 방법을 이용해서 해커가 심어 놓은 코드를 해 개인정보를 가로챌 수 있다.
![[Pasted image 20241126112631.png|SOP가 없는 상황에서의 악의적인 홈페이지 접속 |500]]

1. 사용자가 악성 사이트에 접속
2. 이때 해커가 몰래 심어놓은 악의적인 자바스크립트가 실행되어, 사용자가 모르는 사이에 어느 포털 사이트에 요청을 보낸다.
3. 그럼 포털 사이트에서 해당 브라우저의 쿠키를 이용하여 로그인을 하거나 등 상호작용에 따른 개인 정보를 응답 값을 받은 뒤, 사이트에서 해커 서버(hacker.example.com)로 재차 보낸다.
4. 이외에도 사용자가 접속중인 내부망의 **IP**와 **Port**를 가져오거나, 해커가 사용자 브라우저를 프록시처럼 악용할 수도 있다. 

### 출처 구분 기준 
**Protocol(Scheme), Host, Port** 이 **3가지**가 동일하다면 동일 출처로 판단.

![[Pasted image 20241126113005.png|기준이 되는 출처]]

### 출처 비교와 차단은 브라우저가 수행

출처를 비교하는 로직은 서버에 구현된 스펙이 아닌 **브라우저**에 구현된 스펙이다.

![[Pasted image 20241126113213.png|500]]

